Iptables防火墙

【四表】
nat表（地址转换表）
filter表（数据过滤表）
raw表（状态跟踪表）
mangle表（包标记表）

【五链】
INPUT链（入站规则）
OUTPUT链（出站规则）
FORWARD链（转发规则）
PREROUTING链（路由前规则）
POSTROUTING链（路由后规则）

语法格式：iptables   [-t 表名]  选项  [链名]  [条件]  [-j 目标操作]

//注意事项与规律：
//可以不指定表，默认为filter表
//可以不指定链，默认为对应表的所有链
//如果没有找到匹配条件，则执行防火墙默认规则
//选项/链名/目标操作用大写字母，其余都小写

-选项 
添加规则   -A  追加一条防火墙规则至链的末尾位置
           -I   插入一条防火墙规则至链的开头
查看规则   -L   查看iptables所有规则
           -n   以数字形式显示地址、端口等信息
删除规则   -D   删除链内指定序号（或内容）的一条规则
           -F   删除所有所则规则
默认规则   -P   为指定的链设置默认规则

-条件
   -p协议名称
   -s 源地址   -d 目标地址
   -i 接受数据的网卡   -o 发送数据的网卡
   --sport 源端口号   --dport  目标端口号
  --icmp-type  ICMP类型

-目标操作
 ACCEPT：允许通过/放行
 DROP：直接丢弃，不给出任何回应
 REJECT：拒绝通过，必要时会给出提示
 LOG：记录日志，然后传给下一条规则

【防火墙扩展规则】

格式：iptables 选项 链名称 -m 扩展模块 --具体扩展条件 -j 动作
mac --mac-source
multiport --dports（21,80,443,200:300）
iprange --src-range(192.168.4.1-192.168.4.10)

【NAT规则】
iptables   [-t 表名]  选项  [链名]  [条件]  [-j 动作]
动作
SNAT  
--to-source  指定伪装后的IP地址（公网）

MASQUERADE